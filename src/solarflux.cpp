#include<cmath>

double solarFlux(int type, double Enu){
	double a[6][9];
	double Emax[6], norm[6];
	double fluxtotal, flux, N;

	/*pp parameters*/
	a[0][0] = -2.87034 * pow(10,-1);
	a[0][1] = 1.63559 * pow(10,2);
	a[0][2] = -1.22253 * pow(10,3);
	a[0][3] = 1.55085 * pow(10,4);
	a[0][4] = -1.465140 * pow(10,5);
	a[0][5] = 7.843750 * pow(10,5);
	a[0][6] = -2.35724 * pow(10,6);
	a[0][7] = 3.71082 * pow(10,6);
	a[0][8] = -2.38308 * pow(10,6);
	Emax[0] = 0.428; /*MeV*/
	norm[0] = 5.54*pow(10,10); /*cm⁻²s⁻¹*/

	/*hep parameters*/
	a[1][0] = -2.04975 * pow(10,-6);
	a[1][1] = 4.22577 * pow(10,-3);
	a[1][2] = -4.70817 * pow(10,-4);
	a[1][3] = 2.55332 * pow(10,-5);
	a[1][4] = -2.81714 * pow(10,-6);
	a[1][5] = 3.06961 * pow(10,-7);
	a[1][6] = -1.87479 * pow(10,-8);
	a[1][7] = 6.01396 * pow(10,-10);
	a[1][8] = -7.88874 * pow(10,-12);
	Emax[1] = 18.79; /*MeV*/
	norm[1] = 7.88*pow(10,3); /*cm⁻²s⁻¹*/

	/*8B parameters*/
	a[2][0] = 6.01473 * pow(10,-4);
	a[2][1] = 1.49699 * pow(10,-2);
	a[2][2] = -2.6481 * pow(10,-3);
	a[2][3] = -2.4141 * pow(10,-5);
	a[2][4] = 6.22325 * pow(10,-5);
	a[2][5] = -9.84329 * pow(10,-6);
	a[2][6] = 7.51311 * pow(10,-7);
	a[2][7] = -2.8606 * pow(10,-8);
	a[2][8] = 4.31573 * pow(10,-10);
	Emax[2] = 14.88; /*MeV*/
	norm[2] = 5.74*pow(10,6); /*cm⁻²s⁻¹*/

	/*13N parameters*/
	a[3][0] = -2.59522 * pow(10,-2);
	a[3][1] = 1.05228 * pow(10,1);
	a[3][2] = -3.2344 * pow(10,1);
	a[3][3] = 1.33211 * pow(10,2);
	a[3][4] = -4.11848 * pow(10,2);
	a[3][5] = 7.28405 * pow(10,2);
	a[3][6] = -7.26105 * pow(10,2);
	a[3][7] = 3.8137 * pow(10,2);
	a[3][8] = -8.21149 * pow(10,1);
	Emax[3] = 1.201; /*MeV*/
	norm[3] = 5.70*pow(10,8); /*cm⁻²s⁻¹*/

	/*15O parameters*/
	a[4][0] = -1.36811 * pow(10,-2);
	a[4][1] = 3.94221;
	a[4][2] = -8.55431;
	a[4][3] = 2.36712 * 10;
	a[4][4] = -5.00477 * 10;
	a[4][5] = 6.07542 * 10;
	a[4][6] = -4.15278 * 10;
	a[4][7] = 1.49462 * 10;
	a[4][8] = -2.20367;
	Emax[4] = 1.733; /*MeV*/
	norm[4] = 4.98*pow(10,8); /*cm⁻²s⁻¹*/

	/*17F parameters*/
	a[5][0] = -6.74473 * pow(10,-2);
	a[5][1] = 4.63141;
	a[5][2] = -1.1535 * 10;
	a[5][3] = 2.85067 * 10;
	a[5][4] = -5.11664 * 10;
	a[5][5] = 5.51102 * 10;
	a[5][6] = -3.45332 * 10;
	a[5][7] = 1.1655 * 10;
	a[5][8] = -1.63814 ;
	Emax[5] = 1.74; /*MeV*/
	norm[5] = 5.87*pow(10,6); /*cm⁻²s⁻¹*/

	fluxtotal = 0;
	for(int i = 0; i <= 5; i ++){
		flux = 0;
		if((type == 0 || type == i+1) && Enu < Emax[i]){
			N = 0;
			for(int j = 0; j <= 8; j++){
				flux += a[i][j] * pow(Enu,j+1);
				N += pow(j+2,-1) * a[i][j] * pow(Emax[i],j+2);
			}
			flux *= pow(N,-1)*norm[i];
		}
		fluxtotal += flux;
	}

	return(fluxtotal);
}